<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D 向量計算器</title>
    <style>
        :root {
            /* Primitive Color Tokens */
            --color-white: rgba(255, 255, 255, 1);
            --color-black: rgba(0, 0, 0, 1);
            --color-cream-50: rgba(252, 252, 249, 1);
            --color-cream-100: rgba(255, 255, 253, 1);
            --color-gray-200: rgba(245, 245, 245, 1);
            --color-gray-300: rgba(167, 169, 169, 1);
            --color-gray-400: rgba(119, 124, 124, 1);
            --color-slate-500: rgba(98, 108, 113, 1);
            --color-brown-600: rgba(94, 82, 64, 1);
            --color-charcoal-700: rgba(31, 33, 33, 1);
            --color-charcoal-800: rgba(38, 40, 40, 1);
            --color-slate-900: rgba(19, 52, 59, 1);
            --color-teal-300: rgba(50, 184, 198, 1);
            --color-teal-400: rgba(45, 166, 178, 1);
            --color-teal-500: rgba(33, 128, 141, 1);
            --color-teal-600: rgba(29, 116, 128, 1);
            --color-teal-700: rgba(26, 104, 115, 1);
            --color-teal-800: rgba(41, 150, 161, 1);
            --color-red-400: rgba(255, 84, 89, 1);
            --color-red-500: rgba(192, 21, 47, 1);
            --color-orange-400: rgba(230, 129, 97, 1);
            --color-orange-500: rgba(168, 75, 47, 1);

            /* RGB versions for opacity control */
            --color-brown-600-rgb: 94, 82, 64;
            --color-teal-500-rgb: 33, 128, 141;
            --color-slate-900-rgb: 19, 52, 59;
            --color-slate-500-rgb: 98, 108, 113;
            --color-red-500-rgb: 192, 21, 47;
            --color-red-400-rgb: 255, 84, 89;
            --color-orange-500-rgb: 168, 75, 47;
            --color-orange-400-rgb: 230, 129, 97;

            /* Background color tokens (Light Mode) */
            --color-bg-1: rgba(59, 130, 246, 0.08);
            --color-bg-2: rgba(245, 158, 11, 0.08);
            --color-bg-3: rgba(34, 197, 94, 0.08);
            --color-bg-4: rgba(239, 68, 68, 0.08);
            --color-bg-5: rgba(147, 51, 234, 0.08);
            --color-bg-6: rgba(249, 115, 22, 0.08);
            --color-bg-7: rgba(236, 72, 153, 0.08);
            --color-bg-8: rgba(6, 182, 212, 0.08);

            /* Semantic Color Tokens (Light Mode) */
            --color-background: var(--color-cream-50);
            --color-surface: var(--color-cream-100);
            --color-text: var(--color-slate-900);
            --color-text-secondary: var(--color-slate-500);
            --color-primary: var(--color-teal-500);
            --color-primary-hover: var(--color-teal-600);
            --color-primary-active: var(--color-teal-700);
            --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
            --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
            --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
            --color-border: rgba(var(--color-brown-600-rgb), 0.2);
            --color-btn-primary-text: var(--color-cream-50);
            --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
            --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
            --color-error: var(--color-red-500);
            --color-success: var(--color-teal-500);
            --color-warning: var(--color-orange-500);
            --color-info: var(--color-slate-500);
            --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);
            --color-select-caret: rgba(var(--color-slate-900-rgb), 0.8);

            /* Typography */
            --font-family-base: "FKGroteskNeue", "Geist", "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            --font-family-mono: "Berkeley Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            --font-size-xs: 11px;
            --font-size-sm: 12px;
            --font-size-base: 14px;
            --font-size-md: 14px;
            --font-size-lg: 16px;
            --font-size-xl: 18px;
            --font-size-2xl: 20px;
            --font-size-3xl: 24px;
            --font-size-4xl: 30px;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 550;
            --font-weight-bold: 600;
            --line-height-tight: 1.2;
            --line-height-normal: 1.5;
            --letter-spacing-tight: -0.01em;

            /* Spacing */
            --space-0: 0;
            --space-1: 1px;
            --space-2: 2px;
            --space-4: 4px;
            --space-6: 6px;
            --space-8: 8px;
            --space-10: 10px;
            --space-12: 12px;
            --space-16: 16px;
            --space-20: 20px;
            --space-24: 24px;
            --space-32: 32px;

            /* Border Radius */
            --radius-sm: 6px;
            --radius-base: 8px;
            --radius-md: 10px;
            --radius-lg: 12px;
            --radius-full: 9999px;

            /* Shadows */
            --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.02);
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.04), 0 4px 6px -2px rgba(0, 0, 0, 0.02);
            --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.15), inset 0 -1px 0 rgba(0, 0, 0, 0.03);

            /* Animation */
            --duration-fast: 150ms;
            --duration-normal: 250ms;
            --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --color-gray-400-rgb: 119, 124, 124;
                --color-teal-300-rgb: 50, 184, 198;
                --color-gray-300-rgb: 167, 169, 169;
                --color-gray-200-rgb: 245, 245, 245;

                --color-bg-1: rgba(29, 78, 216, 0.15);
                --color-bg-2: rgba(180, 83, 9, 0.15);
                --color-bg-3: rgba(21, 128, 61, 0.15);
                --color-bg-4: rgba(185, 28, 28, 0.15);
                --color-bg-5: rgba(107, 33, 168, 0.15);
                --color-bg-6: rgba(194, 65, 12, 0.15);
                --color-bg-7: rgba(190, 24, 93, 0.15);
                --color-bg-8: rgba(8, 145, 178, 0.15);

                --color-background: var(--color-charcoal-700);
                --color-surface: var(--color-charcoal-800);
                --color-text: var(--color-gray-200);
                --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
                --color-primary: var(--color-teal-300);
                --color-primary-hover: var(--color-teal-400);
                --color-primary-active: var(--color-teal-800);
                --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
                --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
                --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
                --color-border: rgba(var(--color-gray-400-rgb), 0.3);
                --color-error: var(--color-red-400);
                --color-success: var(--color-teal-300);
                --color-warning: var(--color-orange-400);
                --color-info: var(--color-gray-300);
                --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
                --color-btn-primary-text: var(--color-slate-900);
                --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
                --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
                --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.1), inset 0 -1px 0 rgba(0, 0, 0, 0.15);
                --color-select-caret: rgba(var(--color-gray-200-rgb), 0.8);
            }
        }

        @font-face {
            font-family: 'FKGroteskNeue';
            src: url('https://r2cdn.perplexity.ai/fonts/FKGroteskNeue.woff2') format('woff2');
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-family-base);
            background-color: var(--color-background);
            color: var(--color-text);
            line-height: var(--line-height-normal);
            padding: var(--space-24);
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        h1 {
            font-size: var(--font-size-4xl);
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--space-24);
            text-align: center;
            color: var(--color-text);
            letter-spacing: var(--letter-spacing-tight);
        }

        .tabs {
            display: flex;
            gap: var(--space-8);
            margin-bottom: var(--space-24);
            border-bottom: 2px solid var(--color-border);
            flex-wrap: wrap;
        }

        .tab {
            padding: var(--space-12) var(--space-24);
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: var(--color-text-secondary);
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-standard);
            margin-bottom: -2px;
        }

        .tab:hover {
            color: var(--color-text);
            background: var(--color-secondary);
        }

        .tab.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }

        .tab:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 2px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-24);
            box-shadow: var(--shadow-sm);
            margin-bottom: var(--space-24);
        }

        .formula-display {
            background: var(--color-bg-1);
            padding: var(--space-16);
            border-radius: var(--radius-base);
            margin-bottom: var(--space-24);
            border: 1px solid var(--color-border);
        }

        .formula-display h3 {
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-semibold);
            color: var(--color-text-secondary);
            margin-bottom: var(--space-8);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .formula-display p {
            font-family: var(--font-family-mono);
            font-size: var(--font-size-lg);
            color: var(--color-text);
            margin: 0;
        }

        .vector-inputs {
            display: grid;
            gap: var(--space-24);
            margin-bottom: var(--space-24);
        }

        .vector-group {
            background: var(--color-bg-2);
            padding: var(--space-20);
            border-radius: var(--radius-base);
            border: 1px solid var(--color-border);
        }

        .vector-group h3 {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--space-16);
            color: var(--color-text);
        }

        .input-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-12);
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            color: var(--color-text-secondary);
            margin-bottom: var(--space-6);
        }

        .input-group input {
            padding: var(--space-10) var(--space-12);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            font-size: var(--font-size-base);
            font-family: var(--font-family-mono);
            background: var(--color-surface);
            color: var(--color-text);
            transition: border-color var(--duration-fast) var(--ease-standard);
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px var(--color-focus-ring);
        }

        .input-group input::placeholder {
            color: var(--color-text-secondary);
            opacity: 0.6;
        }

        .hint {
            font-size: var(--font-size-xs);
            color: var(--color-text-secondary);
            margin-top: var(--space-4);
            font-style: italic;
        }

        .buttons {
            display: flex;
            gap: var(--space-12);
            margin-top: var(--space-24);
        }

        .btn {
            padding: var(--space-12) var(--space-24);
            border: none;
            border-radius: var(--radius-base);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-standard);
            font-family: var(--font-family-base);
        }

        .btn-primary {
            background: var(--color-primary);
            color: var(--color-btn-primary-text);
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
        }

        .btn-primary:active {
            background: var(--color-primary-active);
        }

        .btn-primary:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 2px;
        }

        .btn-secondary {
            background: var(--color-secondary);
            color: var(--color-text);
        }

        .btn-secondary:hover {
            background: var(--color-secondary-hover);
        }

        .btn-secondary:active {
            background: var(--color-secondary-active);
        }

        .btn-secondary:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 2px;
        }

        .result-container {
            background: var(--color-bg-3);
            border: 2px solid var(--color-success);
            border-radius: var(--radius-base);
            padding: var(--space-20);
            margin-top: var(--space-24);
        }

        .result-container.hidden {
            display: none;
        }

        .result-container h3 {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-semibold);
            color: var(--color-text);
            margin-bottom: var(--space-16);
        }

        .result-value {
            font-family: var(--font-family-mono);
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text);
            padding: var(--space-16);
            background: var(--color-surface);
            border-radius: var(--radius-base);
            margin-top: var(--space-12);
            word-break: break-word;
        }

        .result-steps {
            margin-top: var(--space-16);
            padding-top: var(--space-16);
            border-top: 1px solid var(--color-border);
        }

        .result-steps h4 {
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-semibold);
            color: var(--color-text-secondary);
            margin-bottom: var(--space-12);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .result-steps p {
            font-family: var(--font-family-mono);
            font-size: var(--font-size-base);
            color: var(--color-text);
            margin-bottom: var(--space-8);
            line-height: 1.6;
        }

        .error-message {
            background: rgba(var(--color-red-500-rgb), 0.1);
            border: 1px solid var(--color-error);
            color: var(--color-error);
            padding: var(--space-12) var(--space-16);
            border-radius: var(--radius-base);
            margin-top: var(--space-16);
            font-size: var(--font-size-sm);
        }

        .error-message.hidden {
            display: none;
        }

        @media (max-width: 768px) {
            body {
                padding: var(--space-16);
            }

            h1 {
                font-size: var(--font-size-3xl);
            }

            .tabs {
                gap: var(--space-4);
            }

            .tab {
                padding: var(--space-10) var(--space-16);
                font-size: var(--font-size-base);
            }

            .card {
                padding: var(--space-16);
            }

            .input-row {
                grid-template-columns: 1fr;
            }

            .buttons {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }

            .result-value {
                font-size: var(--font-size-xl);
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>3D 向量計算器</h1>

        <div class="tabs">
            <button class="tab active" data-tab="dot">點積 (Dot Product)</button>
            <button class="tab" data-tab="cross">叉積 (Cross Product)</button>
            <button class="tab" data-tab="triple">三重積 (Triple Product)</button>
        </div>

        <!-- Dot Product Tab -->
        <div class="tab-content active" id="dot-content">
            <div class="card">
                <div class="formula-display">
                    <h3>公式</h3>
                    <p>A · B = Ax×Bx + Ay×By + Az×Bz</p>
                </div>

                <div class="vector-inputs">
                    <div class="vector-group">
                        <h3>向量 A</h3>
                        <div class="input-row">
                            <div class="input-group">
                                <label for="dot-ax">x 分量</label>
                                <input type="text" id="dot-ax" placeholder="例如: 1/2">
                            </div>
                            <div class="input-group">
                                <label for="dot-ay">y 分量</label>
                                <input type="text" id="dot-ay" placeholder="例如: 3/4">
                            </div>
                            <div class="input-group">
                                <label for="dot-az">z 分量</label>
                                <input type="text" id="dot-az" placeholder="例如: -2/3">
                            </div>
                        </div>
                    </div>

                    <div class="vector-group">
                        <h3>向量 B</h3>
                        <div class="input-row">
                            <div class="input-group">
                                <label for="dot-bx">x 分量</label>
                                <input type="text" id="dot-bx" placeholder="例如: 2">
                            </div>
                            <div class="input-group">
                                <label for="dot-by">y 分量</label>
                                <input type="text" id="dot-by" placeholder="例如: 1/3">
                            </div>
                            <div class="input-group">
                                <label for="dot-bz">z 分量</label>
                                <input type="text" id="dot-bz" placeholder="例如: -1">
                            </div>
                        </div>
                    </div>
                </div>

                <p class="hint">可輸入分數如 1/2, 3/4, -2/3 或整數、小數</p>

                <div class="buttons">
                    <button class="btn btn-primary" onclick="calculateDotProduct()">計算</button>
                    <button class="btn btn-secondary" onclick="clearDotInputs()">清除</button>
                </div>

                <div id="dot-error" class="error-message hidden"></div>
                <div id="dot-result" class="result-container hidden"></div>
            </div>
        </div>

        <!-- Cross Product Tab -->
        <div class="tab-content" id="cross-content">
            <div class="card">
                <div class="formula-display">
                    <h3>公式</h3>
                    <p>A × B = (Ay×Bz - Az×By, Az×Bx - Ax×Bz, Ax×By - Ay×Bx)</p>
                </div>

                <div class="vector-inputs">
                    <div class="vector-group">
                        <h3>向量 A</h3>
                        <div class="input-row">
                            <div class="input-group">
                                <label for="cross-ax">x 分量</label>
                                <input type="text" id="cross-ax" placeholder="例如: 1/2">
                            </div>
                            <div class="input-group">
                                <label for="cross-ay">y 分量</label>
                                <input type="text" id="cross-ay" placeholder="例如: 3/4">
                            </div>
                            <div class="input-group">
                                <label for="cross-az">z 分量</label>
                                <input type="text" id="cross-az" placeholder="例如: -2/3">
                            </div>
                        </div>
                    </div>

                    <div class="vector-group">
                        <h3>向量 B</h3>
                        <div class="input-row">
                            <div class="input-group">
                                <label for="cross-bx">x 分量</label>
                                <input type="text" id="cross-bx" placeholder="例如: 2">
                            </div>
                            <div class="input-group">
                                <label for="cross-by">y 分量</label>
                                <input type="text" id="cross-by" placeholder="例如: 1/3">
                            </div>
                            <div class="input-group">
                                <label for="cross-bz">z 分量</label>
                                <input type="text" id="cross-bz" placeholder="例如: -1">
                            </div>
                        </div>
                    </div>
                </div>

                <p class="hint">可輸入分數如 1/2, 3/4, -2/3 或整數、小數</p>

                <div class="buttons">
                    <button class="btn btn-primary" onclick="calculateCrossProduct()">計算</button>
                    <button class="btn btn-secondary" onclick="clearCrossInputs()">清除</button>
                </div>

                <div id="cross-error" class="error-message hidden"></div>
                <div id="cross-result" class="result-container hidden"></div>
            </div>
        </div>

        <!-- Triple Product Tab -->
        <div class="tab-content" id="triple-content">
            <div class="card">
                <div class="formula-display">
                    <h3>公式</h3>
                    <p>A · (B × C)</p>
                </div>

                <div class="vector-inputs">
                    <div class="vector-group">
                        <h3>向量 A</h3>
                        <div class="input-row">
                            <div class="input-group">
                                <label for="triple-ax">x 分量</label>
                                <input type="text" id="triple-ax" placeholder="例如: 1/2">
                            </div>
                            <div class="input-group">
                                <label for="triple-ay">y 分量</label>
                                <input type="text" id="triple-ay" placeholder="例如: 3/4">
                            </div>
                            <div class="input-group">
                                <label for="triple-az">z 分量</label>
                                <input type="text" id="triple-az" placeholder="例如: -2/3">
                            </div>
                        </div>
                    </div>

                    <div class="vector-group">
                        <h3>向量 B</h3>
                        <div class="input-row">
                            <div class="input-group">
                                <label for="triple-bx">x 分量</label>
                                <input type="text" id="triple-bx" placeholder="例如: 2">
                            </div>
                            <div class="input-group">
                                <label for="triple-by">y 分量</label>
                                <input type="text" id="triple-by" placeholder="例如: 1/3">
                            </div>
                            <div class="input-group">
                                <label for="triple-bz">z 分量</label>
                                <input type="text" id="triple-bz" placeholder="例如: -1">
                            </div>
                        </div>
                    </div>

                    <div class="vector-group">
                        <h3>向量 C</h3>
                        <div class="input-row">
                            <div class="input-group">
                                <label for="triple-cx">x 分量</label>
                                <input type="text" id="triple-cx" placeholder="例如: 1">
                            </div>
                            <div class="input-group">
                                <label for="triple-cy">y 分量</label>
                                <input type="text" id="triple-cy" placeholder="例如: 2/5">
                            </div>
                            <div class="input-group">
                                <label for="triple-cz">z 分量</label>
                                <input type="text" id="triple-cz" placeholder="例如: 3">
                            </div>
                        </div>
                    </div>
                </div>

                <p class="hint">可輸入分數如 1/2, 3/4, -2/3 或整數、小數</p>

                <div class="buttons">
                    <button class="btn btn-primary" onclick="calculateTripleProduct()">計算</button>
                    <button class="btn btn-secondary" onclick="clearTripleInputs()">清除</button>
                </div>

                <div id="triple-error" class="error-message hidden"></div>
                <div id="triple-result" class="result-container hidden"></div>
            </div>
        </div>
    </div>

    <div class="page-header">
        <button class="btn btn--outline back-btn" onclick="window.location.href='index.html'">← 返回主選單 Return to
            Menu</button>
        <h2>矢量計算器 Vector Calculator</h2>
    </div>

    <script>
        // Fraction class for handling fraction arithmetic
        class Fraction {
            constructor(numerator, denominator = 1) {
                if (denominator === 0) {
                    throw new Error('分母不能為零');
                }

                // Handle negative denominators
                if (denominator < 0) {
                    numerator = -numerator;
                    denominator = -denominator;
                }

                const gcd = this.gcd(Math.abs(numerator), Math.abs(denominator));
                this.numerator = numerator / gcd;
                this.denominator = denominator / gcd;
            }

            gcd(a, b) {
                return b === 0 ? a : this.gcd(b, a % b);
            }

            add(other) {
                const num = this.numerator * other.denominator + other.numerator * this.denominator;
                const den = this.denominator * other.denominator;
                return new Fraction(num, den);
            }

            subtract(other) {
                const num = this.numerator * other.denominator - other.numerator * this.denominator;
                const den = this.denominator * other.denominator;
                return new Fraction(num, den);
            }

            multiply(other) {
                return new Fraction(this.numerator * other.numerator, this.denominator * other.denominator);
            }

            toString() {
                if (this.denominator === 1) {
                    return this.numerator.toString();
                }
                return `${this.numerator}/${this.denominator}`;
            }
        }

        // Parse input string to Fraction
        function parseFraction(input) {
            input = input.trim();

            if (input === '') {
                throw new Error('輸入不能為空');
            }

            // Check for fraction format
            if (input.includes('/')) {
                const parts = input.split('/');
                if (parts.length !== 2) {
                    throw new Error(`無效的分數格式: ${input}`);
                }
                const num = parseFloat(parts[0]);
                const den = parseFloat(parts[1]);
                if (isNaN(num) || isNaN(den)) {
                    throw new Error(`無效的數字: ${input}`);
                }
                // Convert to integers if they're decimals
                if (num % 1 !== 0 || den % 1 !== 0) {
                    const decimalPlaces = Math.max(
                        (parts[0].split('.')[1] || '').length,
                        (parts[1].split('.')[1] || '').length
                    );
                    const multiplier = Math.pow(10, decimalPlaces);
                    return new Fraction(Math.round(num * multiplier), Math.round(den * multiplier));
                }
                return new Fraction(num, den);
            } else {
                // Handle decimal or integer
                const num = parseFloat(input);
                if (isNaN(num)) {
                    throw new Error(`無效的數字: ${input}`);
                }
                if (num % 1 === 0) {
                    return new Fraction(num, 1);
                } else {
                    // Convert decimal to fraction
                    const decimalPlaces = (input.split('.')[1] || '').length;
                    const multiplier = Math.pow(10, decimalPlaces);
                    return new Fraction(Math.round(num * multiplier), multiplier);
                }
            }
        }

        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabName = tab.dataset.tab;

                // Update active tab
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // Update active content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(`${tabName}-content`).classList.add('active');
            });
        });

        // Dot Product Calculation
        function calculateDotProduct() {
            const errorDiv = document.getElementById('dot-error');
            const resultDiv = document.getElementById('dot-result');

            try {
                // Parse inputs
                const ax = parseFraction(document.getElementById('dot-ax').value);
                const ay = parseFraction(document.getElementById('dot-ay').value);
                const az = parseFraction(document.getElementById('dot-az').value);
                const bx = parseFraction(document.getElementById('dot-bx').value);
                const by = parseFraction(document.getElementById('dot-by').value);
                const bz = parseFraction(document.getElementById('dot-bz').value);

                // Calculate dot product: A·B = Ax*Bx + Ay*By + Az*Bz
                const term1 = ax.multiply(bx);
                const term2 = ay.multiply(by);
                const term3 = az.multiply(bz);
                const result = term1.add(term2).add(term3);

                // Display result
                errorDiv.classList.add('hidden');
                resultDiv.classList.remove('hidden');
                resultDiv.innerHTML = `
                    <h3>結果</h3>
                    <div class="result-value">${result.toString()}</div>
                    <div class="result-steps">
                        <h4>計算步驟</h4>
                        <p>A · B = (${ax.toString()}) × (${bx.toString()}) + (${ay.toString()}) × (${by.toString()}) + (${az.toString()}) × (${bz.toString()})</p>
                        <p>= ${term1.toString()} + ${term2.toString()} + ${term3.toString()}</p>
                        <p>= ${result.toString()}</p>
                    </div>
                `;
            } catch (error) {
                errorDiv.textContent = `錯誤: ${error.message}`;
                errorDiv.classList.remove('hidden');
                resultDiv.classList.add('hidden');
            }
        }

        function clearDotInputs() {
            document.getElementById('dot-ax').value = '';
            document.getElementById('dot-ay').value = '';
            document.getElementById('dot-az').value = '';
            document.getElementById('dot-bx').value = '';
            document.getElementById('dot-by').value = '';
            document.getElementById('dot-bz').value = '';
            document.getElementById('dot-error').classList.add('hidden');
            document.getElementById('dot-result').classList.add('hidden');
        }

        // Cross Product Calculation
        function calculateCrossProduct() {
            const errorDiv = document.getElementById('cross-error');
            const resultDiv = document.getElementById('cross-result');

            try {
                // Parse inputs
                const ax = parseFraction(document.getElementById('cross-ax').value);
                const ay = parseFraction(document.getElementById('cross-ay').value);
                const az = parseFraction(document.getElementById('cross-az').value);
                const bx = parseFraction(document.getElementById('cross-bx').value);
                const by = parseFraction(document.getElementById('cross-by').value);
                const bz = parseFraction(document.getElementById('cross-bz').value);

                // Calculate cross product: A × B = (Ay*Bz - Az*By, Az*Bx - Ax*Bz, Ax*By - Ay*Bx)
                const cx = ay.multiply(bz).subtract(az.multiply(by));
                const cy = az.multiply(bx).subtract(ax.multiply(bz));
                const cz = ax.multiply(by).subtract(ay.multiply(bx));

                // Display result
                errorDiv.classList.add('hidden');
                resultDiv.classList.remove('hidden');
                resultDiv.innerHTML = `
                    <h3>結果</h3>
                    <div class="result-value">(${cx.toString()}, ${cy.toString()}, ${cz.toString()})</div>
                    <div class="result-steps">
                        <h4>計算步驟</h4>
                        <p>A × B = (Ay×Bz - Az×By, Az×Bx - Ax×Bz, Ax×By - Ay×Bx)</p>
                        <p>x 分量: (${ay.toString()})×(${bz.toString()}) - (${az.toString()})×(${by.toString()}) = ${cx.toString()}</p>
                        <p>y 分量: (${az.toString()})×(${bx.toString()}) - (${ax.toString()})×(${bz.toString()}) = ${cy.toString()}</p>
                        <p>z 分量: (${ax.toString()})×(${by.toString()}) - (${ay.toString()})×(${bx.toString()}) = ${cz.toString()}</p>
                    </div>
                `;
            } catch (error) {
                errorDiv.textContent = `錯誤: ${error.message}`;
                errorDiv.classList.remove('hidden');
                resultDiv.classList.add('hidden');
            }
        }

        function clearCrossInputs() {
            document.getElementById('cross-ax').value = '';
            document.getElementById('cross-ay').value = '';
            document.getElementById('cross-az').value = '';
            document.getElementById('cross-bx').value = '';
            document.getElementById('cross-by').value = '';
            document.getElementById('cross-bz').value = '';
            document.getElementById('cross-error').classList.add('hidden');
            document.getElementById('cross-result').classList.add('hidden');
        }

        // Triple Product Calculation
        function calculateTripleProduct() {
            const errorDiv = document.getElementById('triple-error');
            const resultDiv = document.getElementById('triple-result');

            try {
                // Parse inputs
                const ax = parseFraction(document.getElementById('triple-ax').value);
                const ay = parseFraction(document.getElementById('triple-ay').value);
                const az = parseFraction(document.getElementById('triple-az').value);
                const bx = parseFraction(document.getElementById('triple-bx').value);
                const by = parseFraction(document.getElementById('triple-by').value);
                const bz = parseFraction(document.getElementById('triple-bz').value);
                const cx = parseFraction(document.getElementById('triple-cx').value);
                const cy = parseFraction(document.getElementById('triple-cy').value);
                const cz = parseFraction(document.getElementById('triple-cz').value);

                // Step 1: Calculate B × C
                const bcx = by.multiply(cz).subtract(bz.multiply(cy));
                const bcy = bz.multiply(cx).subtract(bx.multiply(cz));
                const bcz = bx.multiply(cy).subtract(by.multiply(cx));

                // Step 2: Calculate A · (B × C)
                const term1 = ax.multiply(bcx);
                const term2 = ay.multiply(bcy);
                const term3 = az.multiply(bcz);
                const result = term1.add(term2).add(term3);

                // Display result
                errorDiv.classList.add('hidden');
                resultDiv.classList.remove('hidden');
                resultDiv.innerHTML = `
                    <h3>結果</h3>
                    <div class="result-value">${result.toString()}</div>
                    <div class="result-steps">
                        <h4>計算步驟</h4>
                        <p><strong>步驟 1: 計算 B × C</strong></p>
                        <p>B × C = (${bcx.toString()}, ${bcy.toString()}, ${bcz.toString()})</p>
                        <p><strong>步驟 2: 計算 A · (B × C)</strong></p>
                        <p>A · (B × C) = (${ax.toString()}) × (${bcx.toString()}) + (${ay.toString()}) × (${bcy.toString()}) + (${az.toString()}) × (${bcz.toString()})</p>
                        <p>= ${term1.toString()} + ${term2.toString()} + ${term3.toString()}</p>
                        <p>= ${result.toString()}</p>
                    </div>
                `;
            } catch (error) {
                errorDiv.textContent = `錯誤: ${error.message}`;
                errorDiv.classList.remove('hidden');
                resultDiv.classList.add('hidden');
            }
        }

        function clearTripleInputs() {
            document.getElementById('triple-ax').value = '';
            document.getElementById('triple-ay').value = '';
            document.getElementById('triple-az').value = '';
            document.getElementById('triple-bx').value = '';
            document.getElementById('triple-by').value = '';
            document.getElementById('triple-bz').value = '';
            document.getElementById('triple-cx').value = '';
            document.getElementById('triple-cy').value = '';
            document.getElementById('triple-cz').value = '';
            document.getElementById('triple-error').classList.add('hidden');
            document.getElementById('triple-result').classList.add('hidden');
        }
    </script>
</body>

</html>